(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[      7856,        206]
NotebookOptionsPosition[      4962,        150]
NotebookOutlinePosition[      5355,        166]
CellTagsIndexPosition[      5312,        163]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"d654d384-57d5-46bf-be6b-ea1fad121de3"],

Cell[CellGroupData[{

Cell["Init", "Section",ExpressionUUID->"5e1d323f-2d73-4173-ae6f-bbb5370c544e"],

Cell["\<\
Load the package and set the base directory where intermediate files will be \
created:\
\>", "Text",ExpressionUUID->"e424bd2f-1b4d-4148-a607-15e62ec02438"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"ParentDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{"Needs", "[", "\"\<AstronomicalDiaries`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"b3ea4588-b9e7-4a11-b083-292512da60bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ADBase", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<Data\>\""}], 
     "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:=",ExpressionUUID->"8f6617a6-818d-4802-bd15-e754a2e31cde"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Getting texts", "Section",ExpressionUUID->"5adb787c-752c-414b-a07b-5379639897bc"],

Cell[TextData[{
 "Download the texts and metadata from Oracc and then create a file called ",
 StyleBox["revisdOracc.txt", "Program"],
 " that can be edited to fix errors in the Oracc texts:"
}], "Text",ExpressionUUID->"ffe8dc62-f3b2-4d93-b449-423fb5539921"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ADRevisedOraccExport", "[", "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"974617a7-df68-4f2c-bf4e-f1c6d8adb3b1"],

Cell[BoxData["\<\"/Users/christopher/git/ComputableAstronomicalDiaries/\
InputTexts/revisedOracc.txt\"\>"], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"43fb3fa0-6df0-4617-8bdf-7895a8759654"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parsing", "Section",ExpressionUUID->"2cd32681-5414-47a5-b380-33d9485feb4c"],

Cell["\<\
Make sure that the OpenAI API key is set through SystemCredential:\
\>", "Text",ExpressionUUID->"25e04915-d387-4630-b62a-813fe65bc499"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SystemCredential", "[", "\"\<OPENAI_API_KEY\>\"", "]"}], 
   "=", "\"\<<your api key>\>\""}], "*)"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"92b62a63-083e-4cdb-9e03-26655364802b"],

Cell[CellGroupData[{

Cell["Line months", "Subsection",ExpressionUUID->"7c0b5bec-6537-48f6-9d3e-62cd0a70f23c"],

Cell["Automatically find the mapping from line numbers to months:", "Text",ExpressionUUID->"a2ac3ccb-7dd8-4f1b-832a-2571cde8f80d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ADLineMonths", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"8fe057c1-869c-4029-bb73-9f6b44131955"],

Cell["\<\
If the automatically-generated mapping from line numbers to months was wrong, \
it can be hardcoded. The line below creates an editable file that can be used \
to hardcode the line-month mapping:\
\>", "Text",ExpressionUUID->"4c056f58-4c95-4db9-87a2-542a2269f069"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ADLineMonthHardcode", "[", "\"\<X102611\>\"", "]"}], 
  "*)"}]], "Input",ExpressionUUID->"5e66648a-2ec1-45c2-bed0-7a58df8647e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Observation flagging", "Subsection",ExpressionUUID->"b7d1cdee-131c-4d7a-a9e4-00a0c67f0970"],

Cell["Find all the substrings that contain observations:", "Text",ExpressionUUID->"0bcfbc82-b097-443f-9d41-fa6544673e31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ADObservationIDs", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"3831037a-9c62-4030-8235-2f7033ff5fa9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Observation parsing", "Subsection",ExpressionUUID->"86d0f5ea-da2d-4c59-a4b2-9105f4d76596"],

Cell["Parse the observation substrings:", "Text",ExpressionUUID->"23303b57-cd68-425b-b4f5-c2343b3dc3a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ADObservationParses", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"492a05c5-ec37-4951-96a6-2ff96193864f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dataset construction", "Subsection",ExpressionUUID->"4e649896-66f3-4d84-ae3f-7667a0bcec6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ADObservations", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"cc4a5d74-a00d-49bd-b34d-7acb68aabb82"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{354, Automatic}, {Automatic, 39}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8e7ee2c9-6c2c-41f0-bd9c-7699b98b808c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 108, 1, 29, "Input",ExpressionUUID->"d654d384-57d5-46bf-be6b-ea1fad121de3"],
Cell[CellGroupData[{
Cell[687, 25, 78, 0, 66, "Section",ExpressionUUID->"5e1d323f-2d73-4173-ae6f-bbb5370c544e"],
Cell[768, 27, 166, 3, 33, "Text",ExpressionUUID->"e424bd2f-1b4d-4148-a607-15e62ec02438"],
Cell[937, 32, 364, 8, 65, "Input",ExpressionUUID->"b3ea4588-b9e7-4a11-b083-292512da60bd",
 InitializationCell->True],
Cell[1304, 42, 376, 10, 45, "Input",ExpressionUUID->"8f6617a6-818d-4802-bd15-e754a2e31cde",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1717, 57, 87, 0, 66, "Section",ExpressionUUID->"5adb787c-752c-414b-a07b-5379639897bc"],
Cell[1807, 59, 258, 4, 55, "Text",ExpressionUUID->"ffe8dc62-f3b2-4d93-b449-423fb5539921"],
Cell[CellGroupData[{
Cell[2090, 67, 146, 2, 29, "Input",ExpressionUUID->"974617a7-df68-4f2c-bf4e-f1c6d8adb3b1"],
Cell[2239, 71, 195, 2, 33, "Output",ExpressionUUID->"43fb3fa0-6df0-4617-8bdf-7895a8759654"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2483, 79, 81, 0, 66, "Section",ExpressionUUID->"2cd32681-5414-47a5-b380-33d9485feb4c"],
Cell[2567, 81, 145, 2, 33, "Text",ExpressionUUID->"25e04915-d387-4630-b62a-813fe65bc499"],
Cell[2715, 85, 242, 5, 29, "Input",ExpressionUUID->"92b62a63-083e-4cdb-9e03-26655364802b"],
Cell[CellGroupData[{
Cell[2982, 94, 88, 0, 53, "Subsection",ExpressionUUID->"7c0b5bec-6537-48f6-9d3e-62cd0a70f23c"],
Cell[3073, 96, 130, 0, 33, "Text",ExpressionUUID->"a2ac3ccb-7dd8-4f1b-832a-2571cde8f80d"],
Cell[3206, 98, 157, 3, 29, "Input",ExpressionUUID->"8fe057c1-869c-4029-bb73-9f6b44131955"],
Cell[3366, 103, 274, 4, 55, "Text",ExpressionUUID->"4c056f58-4c95-4db9-87a2-542a2269f069"],
Cell[3643, 109, 169, 3, 29, "Input",ExpressionUUID->"5e66648a-2ec1-45c2-bed0-7a58df8647e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3849, 117, 97, 0, 53, "Subsection",ExpressionUUID->"b7d1cdee-131c-4d7a-a9e4-00a0c67f0970"],
Cell[3949, 119, 121, 0, 33, "Text",ExpressionUUID->"0bcfbc82-b097-443f-9d41-fa6544673e31"],
Cell[4073, 121, 160, 3, 29, "Input",ExpressionUUID->"3831037a-9c62-4030-8235-2f7033ff5fa9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4270, 129, 96, 0, 53, "Subsection",ExpressionUUID->"86d0f5ea-da2d-4c59-a4b2-9105f4d76596"],
Cell[4369, 131, 104, 0, 33, "Text",ExpressionUUID->"23303b57-cd68-425b-b4f5-c2343b3dc3a1"],
Cell[4476, 133, 163, 3, 29, "Input",ExpressionUUID->"492a05c5-ec37-4951-96a6-2ff96193864f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4676, 141, 97, 0, 53, "Subsection",ExpressionUUID->"4e649896-66f3-4d84-ae3f-7667a0bcec6a"],
Cell[4776, 143, 158, 3, 29, "Input",ExpressionUUID->"cc4a5d74-a00d-49bd-b34d-7acb68aabb82"]
}, Open  ]]
}, Open  ]]
}
]
*)

